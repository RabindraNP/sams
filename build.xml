<!--
	Master Build for SAMS
	$Id$

	External dependencies:
		- External required libraries for the final SAMS application
		  are located in directory lib/.

	For a complete build:
		ant assembly
-->
<project name="sams" default="compile" >
	<!-- Base dir for generated files.
	     only used here for target clean-dist -->
	<property name="generated" value="../_GENERATED/sams"/>

	<property name="VERSION" value="3.2.1"/>

    <target name="clean-dist">
		<delete dir="${generated}"/>
    </target>

	<target name="compile">
		<ant dir="fileutils" inheritAll="false"/>
		<ant dir="sig" inheritAll="false"/>
		<ant dir="sigoper" inheritAll="false"/>
		<ant dir="specfile" inheritAll="false"/>
		<ant dir="sfsys" inheritAll="false"/>
		<ant dir="envifile" inheritAll="false"/>
		<ant dir="samscore" inheritAll="false"/>
		<ant dir="samsgui" inheritAll="false"/>
	</target>

	<target name="assembly" depends="compile">
		<property name="dist" value="${generated}/DIST"/>
		<property name="assemblage" value="${dist}/assemblage" />
		<mkdir dir="${assemblage}" />

		<copydir src="samsgui/base_dist/opers"   dest="${assemblage}/opers"/>

		<unjar src="lib/bsh-1.3b2.jar"           dest="${assemblage}" />
		<unjar src="lib/kunststoff.jar"          dest="${assemblage}" />
		<unjar src="lib/plotapplication.jar"     dest="${assemblage}" />

		<unjar src="${dist}/fileutils.jar"       dest="${assemblage}" />
		<unjar src="${dist}/sig.jar"             dest="${assemblage}" />
		<unjar src="${dist}/sigoper.jar"         dest="${assemblage}" />
		<unjar src="${dist}/specfile.jar"        dest="${assemblage}" />
		<unjar src="${dist}/sfsys.jar"           dest="${assemblage}" />
		<unjar src="${dist}/envifile.jar"        dest="${assemblage}" />
		<unjar src="${dist}/samscore.jar"        dest="${assemblage}" />
		<unjar src="${dist}/sams.jar"            dest="${assemblage}" />

		<jar jarfile="${dist}/sams-${VERSION}.jar"
			 basedir="${assemblage}"
		>
			<manifest>
				<attribute name="Built-By" value="${user.name}"/>
				<attribute name="Main-class" value="samsgui.Main"/>
			</manifest>
		</jar>
	</target>

</project>
